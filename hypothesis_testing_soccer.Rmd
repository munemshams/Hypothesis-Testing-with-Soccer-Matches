---
title: "Untitled"
output:
  word_document: default
  html_document: default
date: "2026-02-22"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
###############################
#  Hypothesis Testing: Goals in Men's vs Women's World Cup Matches
#  Best Combined Script
###############################

library(tidyverse)
library(gridExtra)

# -------------------------------------------------------------
# 1. Load Data
# -------------------------------------------------------------
women <- read_csv("women_results.csv")
men   <- read_csv("men_results.csv")

# -------------------------------------------------------------
# 2. Filter Only FIFA World Cup Matches After 2002-01-01
# -------------------------------------------------------------
women_wc <- women %>%
  filter(tournament == "FIFA World Cup",
         date > "2002-01-01") %>%
  mutate(goals_scored = home_score + away_score)

men_wc <- men %>%
  filter(tournament == "FIFA World Cup",
         date > "2002-01-01") %>%
  mutate(goals_scored = home_score + away_score)

# -------------------------------------------------------------
# 3. Visual Check of Distribution (Normality Check)
# -------------------------------------------------------------
p1 <- ggplot(men_wc, aes(x = goals_scored)) +
  geom_histogram(fill = "red", bins = 30, alpha = 0.75) +
  labs(title = "Goals Scored - Men's World Cup Matches",
       x = "Goals Scored", y = "Frequency")

p2 <- ggplot(women_wc, aes(x = goals_scored)) +
  geom_histogram(fill = "blue", bins = 30, alpha = 0.75) +
  labs(title = "Goals Scored - Women's World Cup Matches",
       x = "Goals Scored", y = "Frequency")

grid.arrange(p1, p2, nrow = 1)

# Comment:
# Both distributions are skewed → t-test assumptions fail.
# Appropriate test: Mann-Whitney U (Wilcoxon rank-sum test)

# -------------------------------------------------------------
# 4. Hypothesis Test (One-sided)
#
# H0: women's mean goals == men's mean goals
# HA: women's mean goals > men's mean goals
# α = 0.10
# -------------------------------------------------------------

test_results <- wilcox.test(
  x = women_wc$goals_scored,
  y = men_wc$goals_scored,
  alternative = "greater"
)

p_val <- as.numeric(test_results$p.value)

# Decision at 10% significance level
decision <- ifelse(p_val < 0.10, "reject", "fail to reject")

# -------------------------------------------------------------
# 5. Store Final Results in Required Format
# -------------------------------------------------------------
result_df <- data.frame(
  p_val = p_val,
  result = decision
)

print(result_df)
```

